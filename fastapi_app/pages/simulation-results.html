<!DOCTYPE html>
<html lang="en-us">
  <head>
    {% set title= 'Simulation Results' %}
    {% include '_head.html' %}
    {% include '_style_msg_box.html' %}
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  </head>
  <body onload="redirect_if_cookie_is_missing(true, true);
                load_results({{ project_id }});
                show_user_email_in_navbar();">
  {% include '_navbar.html' %}
  {% include '_wizard.html' %}
    <main>
      <section id="dashboard" class="dashboard">
        <div>
          <div class="row">
            <div class="col col-md-7">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title">Grid Layout</span>
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="map">
                    <div id="map" style="width: 100%; height: 100%"></div>
                </div>
              </div>
            </div>
            <div class="col col-md-5"   style="display: flex; justify-content: center;">
              <div class="chart">
                <div class="chart__header">
                  <span class="title">Summary of Results</span>
                </div>
                <div class="chart__content">
                  <span class="subtitle">GRID</span>
                  <div class="row">
                    <div class="item item--best">
                      <div class="item__name">Number of Consumers</div>
                      <div id="nConsumers" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Number of SHS Consumers</div>
                      <div id="nShsConsumers" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Number of Poles</div>
                      <div id="nPoles" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Maximum Voltage Drop</div>
                      <div id="maxVoltageDrop" class="item__value"></div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="item item--best">
                      <div class="item__name">Distribution Cable Length</div>
                      <div
                        id="lengthDistributionCable"
                        class="item__value"
                      ></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Average Length Distribution</div>
                      <div
                        id="averageLengthDistributionCable"
                        class="item__value"
                      ></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Connection Cable Length</div>
                      <div id="lengthConnectionCable" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Average Length Connection</div>
                      <div
                        id="averageLengthConnectionCable"
                        class="item__value"
                      ></div>
                    </div>
                  </div>
                  <span class="subtitle">ENERGY SYSTEM</span>
                  <div class="row">
                    <div class="item item--best">
                      <div class="item__name">Renewable Energy Share</div>
                      <div id="res" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Surplus Electricity</div>
                      <div id="surplusRate" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Total Amount of Shortage</div>
                      <div id="shortageTotal" class="item__value"></div>
                    </div>
                    <div class="item item--best">
                      <div class="item__name">Total CO2 Savings</div>
                      <div id="co2Savings" class="item__value"></div>
                    </div>
                  </div>
                  <span class="subtitle">TOTAL</span>
                  <div class="row">
                    <div class="item item--worst">
                      <div class="item__name">
                        Levelized Cost of Electricity
                      </div>
                      <div id="lcoe" class="item__value"></div>
                    </div>
                    <div class="item item--worst">
                      <div class="item__name">Calculation Time</div>
                      <div id="time" class="item__value"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row" style="padding: 12px">
          <a id="downloadCSV"
          class="btn btn--medium"
          style="height: 32px; display: flex; align-items: center; justify-content: center"
          href="#">Download results (xlsx-format)</a>
          </div>
          <div class="row">
            <div class="col">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title"
                      >Demand Coverage by Renewable and Non-Renewable
                      Resources</span
                    >
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="demandCoverage"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title"
                      >Annual Energy Flows with 1-Hour Resolution</span
                    >
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="energyFlows"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col col-md-6">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title">Optimal Capacity of Components</span>
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="optimalSizes"></div>
                </div>
              </div>
            </div>
            <div class="col col-md-6">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title">Breakdown of the LCOE</span>
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="lcoeBreakdown"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col col-md-7">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title"
                      >Duration Curves for All Components</span
                    >
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="durationCurves"></div>
                </div>
              </div>
            </div>
            <div class="col col-md-5">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title">Cumulative CO2 Emissions</span>
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="co2Emissions"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="chart">
                <div class="chart__header">
                  <div>
                    <span class="title"
                      >Sankey Diagram Representing the Energy Flow in the
                      System</span
                    >
                  </div>
                  <div class="dropdown">
                    <button
                      class="btn dropdown-toggle btn--transparent"
                      type="button"
                      id="dropdownMenuButton1"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      <span class="icon icon-more"></span>
                    </button>
                    <ul
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton1"
                    >
                      <li>
                        <a class="dropdown-item" href="#">Export as .xls</a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="#">Export as PDF</a>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="chart__plot">
                  <div id="sankeyDiagram"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    <div id=noResults class="modal">
        <span  class="close" title="Close Modal">&times;</span>
        <form class="modal-content" action="/action_page.php">
            <div class="container">
                <h1>No results</h1>
                <p id="pendingTaskMSG"></p>
                <a href="/" class="btn btn--long text-right">Back to projects overview</a>
            </div>
        </form>
    </div>
        {% include '_warningBox.html' %}
    </main>
    {% include '_footer.html' %}
  </body>
  {% include '_scripts.html' %}
    <script src="{{ url_for('static', path='js/integrate_map.js') }}"></script>
  <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="https://cdn.plot.ly/plotly-2.0.0.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.0/jspdf.umd.min.js"></script>
<script src="{{ url_for('static', path='js/plots.js') }}"></script>
<script>
    document.getElementById('downloadCSV').addEventListener('click', function() {
    window.location.href = '/download_data/{{ project_id }}/csv';
        });
    var targetNode = document.getElementById('responseMsg');
    var config = { childList: true, subtree: true, characterData: true };
    var callback = function(mutationsList, observer) {
        for(let mutation of mutationsList) {
            if ((mutation.type === 'childList' || mutation.type === 'characterData') && targetNode.textContent.trim() !== '') {
                var modal = document.getElementById('msgBox');
                modal.style.display = "block";
            }
        }
    };
    var observer = new MutationObserver(callback);
    observer.observe(targetNode, config);
    document.getElementById("msgBox").style.zIndex = "9999";
</script>
</html>
